"use strict";(self.webpackChunkincrypto=self.webpackChunkincrypto||[]).push([[971],{43757:(e,a,t)=>{t.d(a,{A:()=>s});t(65043);var c=t(70579);const s=()=>(0,c.jsx)("div",{className:"access-denied-container",children:(0,c.jsxs)("div",{className:"access-denied-box",children:[(0,c.jsx)("h2",{children:"Acceso Denegado"}),(0,c.jsx)("p",{children:"No tienes permiso para acceder"})]})})},1971:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var c=t(65043),s=t(73216),n=t(86213),r=t(13204),l=t(43757),i=t(70579);const o=()=>{const{id:e}=(0,s.g)(),[a,t]=(0,c.useState)(null),[o,d]=(0,c.useState)([]),[h,u]=(0,c.useState)([]),[m,x]=(0,c.useState)(!1),[j,p]=(0,c.useState)(!1),[b,N]=(0,c.useState)(null),[g,f]=(0,c.useState)(""),[v,C]=(0,c.useState)(""),[k,A]=(0,c.useState)(!0),y=(0,s.Zp)();(0,c.useEffect)((()=>{const e=localStorage.getItem("userId");n.A.get("http://localhost:5000/api/userdata/UserRole/".concat(e,"/verify-role"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((e=>{f(e.data.role),A(!1)})).catch((e=>{console.error("Error fetching user role:",e),A(!1)}))}),[]),(0,c.useEffect)((()=>{n.A.get("http://localhost:5000/api/crm/user/".concat(e)).then((e=>t(e.data))).catch((e=>console.error("Error fetching user details:",e))),n.A.get("http://localhost:5000/api/notifications/user/".concat(e)).then((e=>d(e.data))).catch((e=>console.error("Error fetching notifications:",e))),n.A.get("http://localhost:5000/api/transactions/".concat(e)).then((e=>u(e.data))).catch((e=>console.error("Error fetching transactions:",e)))}),[e]);const S=()=>{p(!1),C("")};return k?(0,i.jsx)("div",{children:"Loading..."}):"agent"!==g&&"admin"!==g?(0,i.jsx)(l.A,{}):a?(0,i.jsxs)("div",{className:"user-detail-container",children:[(0,i.jsxs)("h1",{children:[a.firstName," ",a.lastName]}),(0,i.jsxs)("p",{children:["Email: ",a.email]}),(0,i.jsxs)("div",{className:"buttons",children:[(0,i.jsx)("button",{className:"btn add-deposit",onClick:()=>y("/crm/user/".concat(e,"/add-deposit")),children:"A\xf1adir Dep\xf3sito"}),(0,i.jsx)("button",{className:"btn create-notification",onClick:()=>y("/crm/user/".concat(e,"/create-notification")),children:"Crear Notificaci\xf3n"}),(0,i.jsx)("button",{className:"btn delete-account",onClick:async()=>{if(window.confirm("\xbfEstas seguro que quieres eliminar esta cuenta?"))try{await n.A.delete("http://localhost:5000/api/crm/user/".concat(e)),alert("Cuenta borrada con \xe9xito"),y("/crm")}catch(a){console.error("Error deleting account",a),alert("Error al borrar la cuenta")}},children:"Borrar Cuenta"}),"admin"===g&&(0,i.jsx)("button",{className:"btn change-role",onClick:()=>{p(!0)},children:"Cambiar Rol"}),(0,i.jsx)("button",{className:"btn back",onClick:()=>y(-1),children:"Volver"})]}),(0,i.jsx)("h2",{children:"Wallets"}),(0,i.jsx)("ul",{className:"wallets-list",children:a.wallets.map((e=>(0,i.jsxs)("li",{className:"wallet-item",children:[(0,i.jsx)("span",{className:"wallet-cryptocurrency",children:e.cryptocurrency}),": ",(0,i.jsx)("span",{className:"wallet-balance",children:e.balance})," (Address: ",(0,i.jsx)("span",{className:"wallet-address",children:e.address}),")"]},e._id)))}),(0,i.jsx)("h2",{children:"Notificaciones"}),(0,i.jsx)("ul",{className:"notification-list",children:o.map((e=>(0,i.jsxs)("li",{className:"notification-item ".concat(e.read?"read":"unread"),children:[(0,i.jsxs)("div",{className:"notification-content",onClick:()=>y("/crm/notification/".concat(e._id,"/edit")),children:[(0,i.jsx)("h3",{children:e.title}),(0,i.jsx)("p",{children:e.text}),(0,i.jsx)("p",{children:(0,i.jsx)("small",{children:new Date(e.date).toLocaleString()})})]}),(0,i.jsx)(r.uO9,{className:"icon edit-icon"})]},e._id)))}),(0,i.jsx)("h2",{children:"Transacciones"}),(0,i.jsx)("ul",{className:"transaction-list",children:h.map((e=>(0,i.jsxs)("li",{className:"transaction-item",children:[(0,i.jsxs)("strong",{children:[e.type,":"]})," ",e.amount," ",e.currencyLabel,(0,i.jsx)("p",{children:(0,i.jsx)("small",{children:new Date(e.date).toLocaleString()})}),(0,i.jsx)(r.RCe,{className:"icon delete-icon",onClick:()=>(e=>{N(e),x(!0)})(e)})]},e._id)))}),m&&(0,i.jsx)("div",{className:"modal",children:(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsx)("h3",{children:(0,i.jsx)("strong",{children:"Borrar Transacci\xf3n"})}),(0,i.jsx)("p",{children:"\xbfEst\xe1s seguro de eliminar esta transacci\xf3n del historial del usuario?"}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:b.type}),": ",b.amount," ",b.currencyLabel]}),(0,i.jsxs)("div",{className:"modal-buttons",children:[(0,i.jsx)("button",{className:"btn",onClick:()=>(async e=>{try{await n.A.delete("http://localhost:5000/api/transactions/".concat(e)),u(h.filter((a=>a._id!==e))),x(!1)}catch(a){console.error("Error deleting transaction",a),alert("Error al borrar la transacci\xf3n")}})(b._id),children:"Aceptar"}),(0,i.jsx)("button",{className:"btn",onClick:()=>{N(null),x(!1)},children:"Cancelar"})]})]})}),j&&(0,i.jsx)("div",{className:"modal",children:(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsx)("h3",{children:(0,i.jsx)("strong",{children:"Cambiar Rol"})}),(0,i.jsx)("p",{children:"Selecciona el nuevo rol para el usuario:"}),(0,i.jsxs)("select",{value:v,onChange:e=>C(e.target.value),children:[(0,i.jsx)("option",{value:"",children:"Selecciona un rol"}),(0,i.jsx)("option",{value:"user",children:"User"}),(0,i.jsx)("option",{value:"agent",children:"Agent"}),(0,i.jsx)("option",{value:"admin",children:"Admin"})]}),(0,i.jsxs)("div",{className:"modal-buttons",children:[(0,i.jsx)("button",{className:"btn",onClick:async()=>{try{await n.A.put("http://localhost:5000/api/user/role/".concat(e),{role:v},{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),t({...a,role:v}),S(),alert("Rol cambiado con exito")}catch(c){console.error("Error updating role",c),alert("Error al cambiar rol")}},children:"Aceptar"}),(0,i.jsx)("button",{className:"btn",onClick:S,children:"Cancelar"})]})]})})]}):(0,i.jsx)("div",{children:"Loading user details..."})}}}]);
//# sourceMappingURL=971.99ba2bd2.chunk.js.map